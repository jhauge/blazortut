@page "/booking"

@inject BookingService BookingService

<MudText Class="mb-3" Typo="Typo.h3">Booking</MudText>
<MudButtonGroup Color="Color.Primary" Variant="Variant.Filled" Class="my-4 d-flex">
    <MudIconButton Icon="@Icons.Material.Rounded.ArrowBackIos" Title="Forrige måned" aria-label="Tilbage" />
    <MudButton FullWidth="true">Juli 2021</MudButton>
    <MudIconButton Icon="@Icons.Material.Rounded.ArrowForwardIos" Title="Næste måned" aria-label="Frem" />
</MudButtonGroup>
<MudTabs Elevation="2" Rounded="true" ApplyEffectsToContainer="true" PanelClass="">
    <MudTabPanel Text="Kommandantboligen">
        <MudTable Items="@weeks" Class="mt-4">
            <HeaderContent>
                <MudTh>#</MudTh>
                <MudTh>Ma</MudTh>
                <MudTh>Ti</MudTh>
                <MudTh>On</MudTh>
                <MudTh>To</MudTh>
                <MudTh>Fr</MudTh>
                <MudTh>Lø</MudTh>
                <MudTh>Sø</MudTh>
            </HeaderContent>
            <RowTemplate>
                <MudTd DataLabel="#" HideSmall="true" Class="grey lighten-4">U: @context.WeekNumber</MudTd>
                @foreach (BookingDay day in context.BookingDays)
                {
                    <MudTd DataLabel="@day.Date.ToString("ddd")" Class="@(day.IsBooked ? "red lighten-4": "")">
                        @day.Date.ToString("dd")
                        @if (day.IsBooked)
                        {
                            <text>:@day.Account</text>
                        }
                    </MudTd>
                }
            </RowTemplate>
        </MudTable>
    </MudTabPanel>
    <MudTabPanel Text="Laden">
        <MudTable Items="@barnWeeks" Class="mt-4">
            <HeaderContent>
                <MudTh>#</MudTh>
                <MudTh>Ma</MudTh>
                <MudTh>Ti</MudTh>
                <MudTh>On</MudTh>
                <MudTh>To</MudTh>
                <MudTh>Fr</MudTh>
                <MudTh>Lø</MudTh>
                <MudTh>Sø</MudTh>
            </HeaderContent>
            <RowTemplate>
                <MudTd DataLabel="#" HideSmall="true" Class="grey lighten-4">U: @context.WeekNumber</MudTd>
                @foreach (BookingDay day in context.BookingDays)
                {
                    <MudTd DataLabel="@day.Date.ToString("ddd")" Class="@(day.IsBooked ? "red lighten-4": "")">
                        @day.Date.ToString("dd")
                        @if (day.IsBooked)
                        {
                            <text>:@day.Account</text>
                        }
                    </MudTd>
                }
            </RowTemplate>
        </MudTable>
    </MudTabPanel>
</MudTabs>

@* <MudGrid>
    <MudItem xs="12" m="6">
    <MudButtonGroup Color="Color.Primary" Variant="Variant.Filled">
    <MudButton>Kommandantboligen</MudButton>
    <MudButton>Laden</MudButton>
    </MudButtonGroup>
    </MudItem>
    </MudGrid> *@
@* <MudGrid>
    <MudItem xs="12" md="6">
    <MudDatePicker Label="Vælg måned" OpenTo="OpenTo.Month" @bind-Date="currentStartDate" DateFormat="MMMM" />
    </MudItem>
    </MudGrid> *@

@code {
    private List<BookingWeek> weeks;
    private List<BookingWeek> barnWeeks;
    DateTime? currentStartDate = DateTime.Today;

    protected override async Task OnInitializedAsync()
    {
        weeks = await BookingService.GetBookingsAsync("comm");
        barnWeeks = await BookingService.GetBookingsAsync("barn");

    }
}